<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
 <mapper namespace="com.hot6.project.dao.AdminUserDAO">
  
  	<!-- 전체 회원 정보 -->
  	<select id="getUserInfo" resultType="UserVO">	
  		select user_nick, user_id, user_name, tel, email, date_format(register_date,'%Y.%m.%d') as register_date, permission, want, career_year, career
  		from user order by user_id limit ${onePageRecord} offset ${offsetIndex}
  	</select>
  	
  	<!-- 해당 회원 수 -->
  	<select id="getAllCnt" resultType="int">
  		select count(user_id) from user
  		<where>
  			<!-- user -->
  			<if test="param1 !=null and param1!='all'"> permission=#{param1}</if>
  			<!--  mento신 -->		
  			<if test="param2!=null">AND want='T'</if>
  		</where>
  		
  	</select> 	  
  	
  	<!-- 일반 회원 수 -->
  	<select id="getUserCnt" resultType="int">
  		select count(user_id) from user where permission = "user"
  	</select>	
  	
  	<!-- 멘토 회원 수 -->
  	<select id="getMentorCnt" resultType="int">
  		select count(user_id) from user where permission = "mentor"
  	</select>	
  	
  	<!-- 관리자 수 -->
  	<select id="getAdminCnt" resultType="int">
  		select count(user_id) from user where permission="admin"
  	</select>
  	
  	<!-- 멘토 신청 대기 회원 -->
  	<select id="">
  	
  	</select>
  	
  	<!-- 해당 회원 -->
  	<select id="userPermission" resultType="UserVO">
  		select user_nick, user_id, user_name, tel, email, date_format(register_date,'%Y.%m.%d') as register_date, permission, want, career_year, career
  		from user where permission=#{param1} order by user_id limit ${param2.onePageRecord} offset ${param2.offsetIndex}
  	</select>
  	
  	<!-- 멘토 신청 결과 대기 회원 -->
  	<select id="userWant" resultType="UserVO">
  		select user_nick, user_id, user_name, tel, email, date_format(register_date,'%Y.%m.%d') as register_date, permission, want, career_year, career
  		from user where permission=#{param1} and want=#{param2} order by user_id limit ${param3.onePageRecord} offset ${param3.offsetIndex}
  	</select>
  	
  	<!-- 멘토 신청 승인 -->
  	<update id="approveUserStatus">
  		update user set permission="mentor"
  			<where>
  				<foreach item="item" collection="userList" open="user_id in (" separator="," close=")">
  					 #{item}
  				</foreach>
  			</where>
  	</update>
  	
  	<!-- 멘토 신청 반려 -->
  	<update id="sendBackStatus">
  		update user set want="F"
  			<where>
  				<foreach item="item" collection="userList" open="user_id in(" separator="," close=")">
  					#{item}
  				</foreach>		
  			</where>
  	</update>
 </mapper>
 